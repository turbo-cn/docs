(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1945],{3165:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/repo/docs/core-concepts/caching",function(){return s(7092)}])},5449:function(e,n,s){"use strict";s.d(n,{Z:function(){return d}});var o=s(5893),r=s(7294);var i=r.forwardRef((function(e,n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:n},e),r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}))}));var t=r.forwardRef((function(e,n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:n},e),r.createElement("path",{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z"}))}));var a=r.forwardRef((function(e,n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:n},e),r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))}));var l=r.forwardRef((function(e,n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:n},e),r.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))})),c={info:{classes:"bg-blue-100 text-blue-800 dark:text-blue-300 dark:bg-blue-200 dark:bg-opacity-10",icon:(0,o.jsx)(i,{className:"w-5 h-5 mt-1"})},idea:{classes:"bg-gray-100 text-gray-800 dark:text-gray-300 dark:bg-gray-200 dark:bg-opacity-10",icon:(0,o.jsx)(t,{className:"w-5 h-5 mt-1"})},error:{classes:"bg-red-200 text-red-900 dark:text-red-200 dark:bg-red-600 dark:bg-opacity-30",icon:(0,o.jsx)(a,{className:"w-5 h-5 mt-1"})},default:{classes:"bg-orange-100 text-orange-800 dark:text-orange-300 dark:bg-orange-200 dark:bg-opacity-10",icon:(0,o.jsx)(l,{className:"w-5 h-5 mt-1"})}};function d(e){var n=e.children,s=e.type,r=void 0===s?"default":s,i=e.icon;return(0,o.jsxs)("div",{className:"".concat(c[r].classes," flex rounded-lg callout mt-6"),children:[(0,o.jsx)("div",{className:"py-2 pl-3 pr-2 text-xl select-none",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},children:i||c[r].icon}),(0,o.jsx)("div",{className:"py-2 pr-4 overflow-auto",children:n})]})}},7092:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return k.ZP}});var o,r=s(6042),i=s(9396),t=s(5893),a=s(6871),l=s(8583),c=(s(8658),s(1151)),d=s(1608),h=s.n(d),p={src:"/_next/static/media/cache-miss.21d45e92.png",height:1306,width:1710,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAIAAABxZ0isAAAAj0lEQVR42gUA2QqCQHAfygzTGZvt8NqtXFLJgzTzSGghouj/PygYAJoWAXmANrjgB4L4HhFYHKrhNkayULJM1qIbdFW1C2PJdnyTq2tTfMbL+3ecdNwWUeqgyzjfHpK6zL9d8tKyn7L+LFNwbKbkqR8aJTPhZwGI5vEs67sxMxkC0HzFHRvQIiQKJXmBC/gHWDQSELKFnhYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:6},x={src:"/_next/static/media/cache-hit.3bac1eb9.png",height:742,width:1910,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAUElEQVR42gUA2wpAMHTvoilm2dx2zdHUwRp50v7/n0S8BmUCE6tWYAfrar4UTUsrsvtwbCmY70z5ud4s8AacekeKknZMKQFy9qPUqCFGNNz+gj0KcFBxFYkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},u=s(5449),k=s(5764),j={filePath:"pages/repo/docs/core-concepts/caching.mdx",route:"/repo/docs/core-concepts/caching",frontMatter:{title:"Caching",description:"Caching allows Turborepo to skip work that's already been done, for the fastest builds."},pageMap:[{kind:"Meta",data:{"*":{type:"page"},index:{display:"hidden",theme:{layout:"raw",sidebar:!1,toc:!0}},repo:"Repo",pack:"Pack",blog:{title:"\u535a\u5ba2",theme:{typesetting:"article"}},showcase:"\u6848\u4f8b","official-website":{title:"\u5b98\u7f51",href:"https://turbo.build/",newWindow:!0},confirm:{title:"Confirm",display:"hidden"},terms:{title:"\u670d\u52a1\u6761\u6b3e",display:"hidden"},privacy:{title:"\u9690\u79c1\u653f\u7b56",display:"hidden"}}},{kind:"Folder",name:"blog",route:"/blog",children:[{kind:"Meta",data:{"*":{"//":"Hide all the links from the sidebar or navbar, and disable ToC and Sidebar for these pages.",display:"hidden",theme:{toc:!1,sidebar:!1,typesetting:"article"}},"turbo-1-6-0":"Turborepo 1.6","turbo-1-5-0":"Turborepo 1.5","turbo-1-4-0":"Turborepo 1.4","turbo-1-3-0":"Turborepo 1.3","turbo-1-2-0":"Turborepo 1.2","turbo-1-1-0":"Turborepo 1.1","joining-vercel":"Joining Vercel","saml-sso-now-available":"SAML SSO now available","you-might-not-need-typescript-project-references":"You might not need TypeScript project references","turbo-0-4-0":"Turborepo 0.4.0"}},{kind:"MdxPage",name:"joining-vercel",route:"/blog/joining-vercel",frontMatter:{title:"Turborepo is joining Vercel",date:"2021/12/09",description:"Turborepo is joining Vercel to make the web even faster.",tag:"web development",ogImage:"/og-image.png"}},{kind:"MdxPage",name:"saml-sso-now-available",route:"/blog/saml-sso-now-available",frontMatter:{title:"SAML SSO is now available",date:"2021/08/03",description:"SAML Single Sign-on (SSO) is now available to Enterprise customers thanks to our friends over at WorkOS.",tag:"web development",ogImage:"/images/blog/og-saml.png"}},{kind:"MdxPage",name:"turbo-0-4-0",route:"/blog/turbo-0-4-0",frontMatter:{title:"Turborepo 0.4.0",date:"2021/04/02",description:"Turborepo 0.4.0 introduces 10x faster hashing, pruned workspaces with sparse installs, a new pipeline configuration API, and improved cache control.",tag:"web development",ogImage:"/og-image.png"}},{kind:"MdxPage",name:"turbo-1-1-0",route:"/blog/turbo-1-1-0",frontMatter:{title:"Turborepo 1.1",date:"2022/01/31",description:"Turborepo 1.1 introduces automatic migrations, turbo.json configuration, environment variable dependencies, partial Yarn v2 support, and more!",tag:"web development",ogImage:"/images/blog/turbo-1-1-0/twitter-card.png"}},{kind:"MdxPage",name:"turbo-1-2-0",route:"/blog/turbo-1-2-0",frontMatter:{title:"Turborepo 1.2",date:"2022/04/08",description:"Turborepo 1.2 introduces improved task filtering, artifact signing and integrity, human-readable and JSON dry runs, and more!",tag:"web development",ogImage:"/images/blog/turbo-1-2-0/twitter-card.png"}},{kind:"MdxPage",name:"turbo-1-3-0",route:"/blog/turbo-1-3-0",frontMatter:{title:"Turborepo 1.3",date:"2022/06/23",description:"Turborepo 1.3 introduces restricted hash inputs, root script running and caching, new CI/CD Recipes, and more!",tag:"web development",ogImage:"/images/blog/turbo-1-3-0/twitter-card.png"}},{kind:"MdxPage",name:"turbo-1-4-0",route:"/blog/turbo-1-4-0",frontMatter:{title:"Turborepo 1.4",date:"2022/08/09",description:"Turborepo 1.4 has new examples, automatically includes environment variables, and more!",tag:"web development",ogImage:"/images/blog/turbo-1-4-0/twitter-card.png"}},{kind:"MdxPage",name:"turbo-1-5-0",route:"/blog/turbo-1-5-0",frontMatter:{title:"Turborepo 1.5",date:"2022/09/19",description:"Turborepo 1.5 brings the Monorepo Handbook, drops the 'run' command, improves pruning, and much more!",tag:"web development",ogImage:"/images/blog/turbo-1-5-0/twitter-card.png"}},{kind:"MdxPage",name:"turbo-1-6-0",route:"/blog/turbo-1-6-0",frontMatter:{title:"Turborepo 1.6",date:"2022/10/21",description:"Turborepo 1.6 lets you use Turborepo in non-monorepos, prune for npm, and improves cache performance.",tag:"web development",ogImage:"/images/blog/turbo-1-6-0/twitter-card.png"}},{kind:"MdxPage",name:"you-might-not-need-typescript-project-references",route:"/blog/you-might-not-need-typescript-project-references",frontMatter:{title:"You might not need TypeScript project references",date:"2021/04/23",description:'As it turns out, you might not even references or even an interim TypeScript build step with a pattern I am about to show you, which I dub "internal packages."',tag:"web development",ogImage:"/images/blog/og-project-references.png"}}]},{kind:"MdxPage",name:"blog",route:"/blog",frontMatter:{description:"The latest updates and releases from the Turbo team at Vercel.",type:"posts"}},{kind:"MdxPage",name:"confirm",route:"/confirm",frontMatter:{headeronly:!0,searchable:!1}},{kind:"MdxPage",name:"index",route:"/",frontMatter:{description:"Turbo is an incremental bundler and build system optimized for JavaScript and TypeScript, written in Rust."}},{kind:"Folder",name:"pack",route:"/pack",children:[{kind:"Meta",data:{index:{type:"page",display:"hidden",theme:{layout:"raw",sidebar:!1,toc:!0}},docs:{title:"\u6587\u6863",display:"children"}}},{kind:"Folder",name:"docs",route:"/pack/docs",children:[{kind:"Meta",data:{index:"Quickstart","why-turbopack":"Why Turbopack?","core-concepts":"Core Concepts",roadmap:"Roadmap",features:"Features",comparisons:"Comparisons",benchmarks:"Benchmarks","migrating-from-webpack":"Migrating from Webpack"}},{kind:"MdxPage",name:"benchmarks",route:"/pack/docs/benchmarks"},{kind:"Folder",name:"comparisons",route:"/pack/docs/comparisons",children:[{kind:"Meta",data:{"turbopack-vs-vite":"Turbopack vs. Vite","turbopack-vs-webpack":"Turbopack vs. Webpack"}},{kind:"MdxPage",name:"turbopack-vs-vite",route:"/pack/docs/comparisons/turbopack-vs-vite"},{kind:"MdxPage",name:"turbopack-vs-webpack",route:"/pack/docs/comparisons/turbopack-vs-webpack"}]},{kind:"MdxPage",name:"core-concepts",route:"/pack/docs/core-concepts",frontMatter:{title:"Core Concepts",description:"Learn about the innovative architecture that powers Turbopack's speed improvements."}},{kind:"Folder",name:"features",route:"/pack/docs/features",children:[{kind:"Meta",data:{javascript:"JavaScript",typescript:"TypeScript",frameworks:"Frameworks",css:"CSS","dev-server":"Dev Server","static-assets":"Static Assets",imports:"Imports","environment-variables":"Environment Variables"}},{kind:"MdxPage",name:"css",route:"/pack/docs/features/css"},{kind:"MdxPage",name:"dev-server",route:"/pack/docs/features/dev-server"},{kind:"MdxPage",name:"environment-variables",route:"/pack/docs/features/environment-variables"},{kind:"MdxPage",name:"frameworks",route:"/pack/docs/features/frameworks"},{kind:"MdxPage",name:"imports",route:"/pack/docs/features/imports"},{kind:"MdxPage",name:"javascript",route:"/pack/docs/features/javascript"},{kind:"MdxPage",name:"static-assets",route:"/pack/docs/features/static-assets"},{kind:"MdxPage",name:"typescript",route:"/pack/docs/features/typescript"}]},{kind:"MdxPage",name:"features",route:"/pack/docs/features",frontMatter:{title:"Features",description:"Learn about Turbopack's supported features"}},{kind:"MdxPage",name:"index",route:"/pack/docs",frontMatter:{title:"Turbopack Quickstart",description:"Start Building Web Applications with Turbopack"}},{kind:"MdxPage",name:"migrating-from-webpack",route:"/pack/docs/migrating-from-webpack",frontMatter:{title:"Migrate from Webpack to Turbopack",description:"Learn about how to migrate from Webpack to its Rust-powered successor, Turbopack."}},{kind:"MdxPage",name:"roadmap",route:"/pack/docs/roadmap"},{kind:"MdxPage",name:"why-turbopack",route:"/pack/docs/why-turbopack",frontMatter:{title:"Why Turbopack?",description:"Learn why we think Turbopack is the future of bundling for the web."}}]},{kind:"MdxPage",name:"index",route:"/pack",frontMatter:{overrideTitle:"Turbopack - The successor to Webpack",description:"Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust."}}]},{kind:"MdxPage",name:"privacy",route:"/privacy",frontMatter:{description:"See our privacy policy and how it relates to you.",hidden:!0,headeronly:!0,container:!0,searchable:!1}},{kind:"Folder",name:"repo",route:"/repo",children:[{kind:"Meta",data:{index:{type:"page",display:"hidden",theme:{layout:"raw",sidebar:!1,toc:!0}},docs:{title:"Docs",display:"children"}}},{kind:"Folder",name:"docs",route:"/repo/docs",children:[{kind:"Meta",data:{index:{title:"\u5feb\u901f\u5f00\u59cb"},"getting-started":"\u5165\u95e8","core-concepts":"\u6838\u5fc3\u6982\u5ff5",handbook:"Monorepo \u624b\u518c",ci:"CI Recipes",reference:"API \u53c2\u8003",changelog:{title:"\u4fee\u6539\u8bb0\u5f55",href:"https://github.com/vercel/turbo/releases",newWindow:!0},"upgrading-to-v1":"\u5347\u7ea7\u5230 v1",troubleshooting:"\u6545\u969c\u6392\u9664",acknowledgements:"\u81f4\u8c22",faq:"FAQ"}},{kind:"MdxPage",name:"acknowledgements",route:"/repo/docs/acknowledgements",frontMatter:{title:"Acknowledgements and Prior Art",description:"Thank you to all these developers, build systems, and monorepo tools for their support and assistance."}},{kind:"Folder",name:"ci",route:"/repo/docs/ci",children:[{kind:"Meta",data:{circleci:"CircleCI","github-actions":"GitHub Actions",gitlabci:"GitLab CI",travisci:"Travis CI"}},{kind:"MdxPage",name:"circleci",route:"/repo/docs/ci/circleci",frontMatter:{title:"Using Turborepo with CircleCI",description:"How to use CircleCI with Turborepo to optimize your CI workflow"}},{kind:"MdxPage",name:"github-actions",route:"/repo/docs/ci/github-actions",frontMatter:{title:"Using Turborepo with GitHub Actions",description:"How to use GitHub Actions with Turborepo to optimize your CI workflow"}},{kind:"MdxPage",name:"gitlabci",route:"/repo/docs/ci/gitlabci",frontMatter:{title:"Using Turborepo with GitLab CI",description:"How to use GitLab CI with Turborepo to optimize your CI workflow"}},{kind:"MdxPage",name:"travisci",route:"/repo/docs/ci/travisci",frontMatter:{title:"Using Turborepo with Travis CI",description:"How to use Travis CI with Turborepo to optimize your CI workflow"}}]},{kind:"MdxPage",name:"ci",route:"/repo/docs/ci",frontMatter:{title:"Continuous Integration",description:"Recipes for using Turborepo with GitHub Actions, CircleCI, and other continuous integration providers."}},{kind:"Folder",name:"core-concepts",route:"/repo/docs/core-concepts",children:[{kind:"Meta",data:{caching:"Caching Tasks","remote-caching":"Remote Caching",monorepos:"Monorepos",scopes:{display:"hidden"}}},{kind:"MdxPage",name:"caching",route:"/repo/docs/core-concepts/caching",frontMatter:{title:"Caching",description:"Caching allows Turborepo to skip work that's already been done, for the fastest builds."}},{kind:"Folder",name:"monorepos",route:"/repo/docs/core-concepts/monorepos",children:[{kind:"Meta",data:{"running-tasks":"Running Tasks",filtering:"Filtering Workspaces"}},{kind:"MdxPage",name:"filtering",route:"/repo/docs/core-concepts/monorepos/filtering",frontMatter:{title:"Filtering Workspaces",description:"Only build the workspaces you care about"}},{kind:"MdxPage",name:"running-tasks",route:"/repo/docs/core-concepts/monorepos/running-tasks",frontMatter:{title:"Running Tasks",description:"Turborepo helps you specify task dependencies declaratively."}}]},{kind:"MdxPage",name:"monorepos",route:"/repo/docs/core-concepts/monorepos"},{kind:"MdxPage",name:"remote-caching",route:"/repo/docs/core-concepts/remote-caching",frontMatter:{title:"Remote Caching",description:"Share cache artifacts across machines for even faster builds."}},{kind:"MdxPage",name:"scopes",route:"/repo/docs/core-concepts/scopes",frontMatter:{title:"Scoped tasks",description:"Even faster Turborepo builds with scoped tasks.",searchable:!1}}]},{kind:"MdxPage",name:"faq",route:"/repo/docs/faq",frontMatter:{title:"Frequently Asked Questions",description:"Frequently asked questions about Turborepo."}},{kind:"Folder",name:"getting-started",route:"/repo/docs/getting-started",children:[{kind:"Meta",data:{"add-to-project":"Add to Existing Project","create-new":"Create a New Monorepo","existing-monorepo":"Add to Existing Monorepo"}},{kind:"MdxPage",name:"add-to-project",route:"/repo/docs/getting-started/add-to-project"},{kind:"MdxPage",name:"create-new",route:"/repo/docs/getting-started/create-new",frontMatter:{title:"Getting Started with Turborepo",description:"Create your first monorepo or add Turborepo to an existing project."}},{kind:"MdxPage",name:"existing-monorepo",route:"/repo/docs/getting-started/existing-monorepo",frontMatter:{title:"Getting Started with Turborepo",description:"Create your first monorepo or add Turborepo to an existing project."}}]},{kind:"Folder",name:"handbook",route:"/repo/docs/handbook",children:[{kind:"Meta",data:{"what-is-a-monorepo":"What is a Monorepo?","package-installation":"Package Installation",workspaces:"Workspaces","migrating-to-a-monorepo":"Migrating to a Monorepo",dev:"Development Tasks","building-your-app":"Building Your App","deploying-with-docker":"Deploying with Docker","sharing-code":"Sharing Code",linting:"Linting",testing:"Testing","publishing-packages":"Publishing Packages",troubleshooting:"Troubleshooting"}},{kind:"MdxPage",name:"building-your-app",route:"/repo/docs/handbook/building-your-app"},{kind:"MdxPage",name:"deploying-with-docker",route:"/repo/docs/handbook/deploying-with-docker"},{kind:"MdxPage",name:"dev",route:"/repo/docs/handbook/dev"},{kind:"Folder",name:"linting",route:"/repo/docs/handbook/linting",children:[{kind:"Meta",data:{typescript:"TypeScript",eslint:"ESLint"}},{kind:"MdxPage",name:"eslint",route:"/repo/docs/handbook/linting/eslint"},{kind:"MdxPage",name:"typescript",route:"/repo/docs/handbook/linting/typescript"}]},{kind:"MdxPage",name:"linting",route:"/repo/docs/handbook/linting"},{kind:"MdxPage",name:"migrating-to-a-monorepo",route:"/repo/docs/handbook/migrating-to-a-monorepo"},{kind:"MdxPage",name:"package-installation",route:"/repo/docs/handbook/package-installation"},{kind:"Folder",name:"publishing-packages",route:"/repo/docs/handbook/publishing-packages",children:[{kind:"Meta",data:{bundling:"Bundling","versioning-and-publishing":"Versioning and Publishing"}},{kind:"MdxPage",name:"bundling",route:"/repo/docs/handbook/publishing-packages/bundling"},{kind:"MdxPage",name:"versioning-and-publishing",route:"/repo/docs/handbook/publishing-packages/versioning-and-publishing"}]},{kind:"MdxPage",name:"publishing-packages",route:"/repo/docs/handbook/publishing-packages"},{kind:"Folder",name:"sharing-code",route:"/repo/docs/handbook/sharing-code",children:[{kind:"Meta",data:{"internal-packages":"Internal Packages"}},{kind:"MdxPage",name:"internal-packages",route:"/repo/docs/handbook/sharing-code/internal-packages"}]},{kind:"MdxPage",name:"sharing-code",route:"/repo/docs/handbook/sharing-code"},{kind:"MdxPage",name:"testing",route:"/repo/docs/handbook/testing"},{kind:"MdxPage",name:"troubleshooting",route:"/repo/docs/handbook/troubleshooting"},{kind:"MdxPage",name:"what-is-a-monorepo",route:"/repo/docs/handbook/what-is-a-monorepo"},{kind:"MdxPage",name:"workspaces",route:"/repo/docs/handbook/workspaces"}]},{kind:"MdxPage",name:"handbook",route:"/repo/docs/handbook",frontMatter:{title:"Monorepo Handbook",description:"The missing manual on how to set up and use your monorepo."}},{kind:"MdxPage",name:"index",route:"/repo/docs",frontMatter:{title:"Turborepo \u5feb\u901f\u5f00\u59cb",description:"\u521b\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2a monorepo \u6216\u5c06 Turborepo \u6dfb\u52a0\u5230\u73b0\u6709\u9879\u76ee."}},{kind:"Folder",name:"reference",route:"/repo/docs/reference",children:[{kind:"Meta",data:{configuration:"Configuration Options","command-line-reference":"CLI Usage",codemods:"Codemods"}},{kind:"MdxPage",name:"codemods",route:"/repo/docs/reference/codemods",frontMatter:{title:"Turborepo Codemods",description:"To make upgrading easier, Turborepo includes codemods and migration scripts."}},{kind:"MdxPage",name:"command-line-reference",route:"/repo/docs/reference/command-line-reference",frontMatter:{title:"CLI Reference",description:"Turborepo is a high-performance build system for JavaScript and TypeScript codebases."}},{kind:"MdxPage",name:"configuration",route:"/repo/docs/reference/configuration",frontMatter:{title:"Configuration Options - turbo.json",description:"Learn how to configure Turborepo through `turbo.json`."}}]},{kind:"MdxPage",name:"troubleshooting",route:"/repo/docs/troubleshooting",frontMatter:{title:"Troubleshooting",description:"This guide aims to help you debug issues with your Turborepo builds and configuration."}},{kind:"MdxPage",name:"upgrading-to-v1",route:"/repo/docs/upgrading-to-v1",frontMatter:{title:"Upgrading to v1",description:"Learn how to upgrade to Turborepo v1, now open-source and part of Vercel."}}]},{kind:"MdxPage",name:"index",route:"/repo",frontMatter:{description:"Turborepo is a high-performance build system for JavaScript and TypeScript codebases."}}]},{kind:"MdxPage",name:"showcase",route:"/showcase",frontMatter:{headeronly:!0,searchable:!1,description:"Turborepo by Vercel is the one of the fastest growing build systems in the frontend ecosystem. It's trusted by thousands of developers in production including teams at Vercel, AWS, Netflix, Microsoft, Disney, and more."}},{kind:"MdxPage",name:"terms",route:"/terms",frontMatter:{description:"See our terms of our service and how they relate to you.",hidden:!0,headeronly:!0,container:!0,searchable:!1}}],headings:[{type:"heading",depth:1,children:[{type:"text",value:"Caching Tasks",position:{start:{line:4,column:3,offset:58},end:{line:4,column:16,offset:71}}}],position:{start:{line:4,column:1,offset:56},end:{line:4,column:16,offset:71}},value:"Caching Tasks"},{type:"heading",depth:2,children:[{type:"text",value:"Missing the cache",position:{start:{line:10,column:4,offset:333},end:{line:10,column:21,offset:350}}}],position:{start:{line:10,column:1,offset:330},end:{line:10,column:21,offset:350}},value:"Missing the cache"},{type:"heading",depth:2,children:[{type:"text",value:"Hitting the cache",position:{start:{line:35,column:4,offset:1554},end:{line:35,column:21,offset:1571}}}],position:{start:{line:35,column:1,offset:1551},end:{line:35,column:21,offset:1571}},value:"Hitting the cache"},{type:"heading",depth:2,children:[{type:"text",value:"Configuring Cache Outputs",position:{start:{line:49,column:4,offset:2490},end:{line:49,column:29,offset:2515}}}],position:{start:{line:49,column:1,offset:2487},end:{line:49,column:29,offset:2515}},value:"Configuring Cache Outputs"},{type:"heading",depth:2,children:[{type:"text",value:"Configuring Cache Inputs",position:{start:{line:83,column:4,offset:3770},end:{line:83,column:28,offset:3794}}}],position:{start:{line:83,column:1,offset:3767},end:{line:83,column:28,offset:3794}},value:"Configuring Cache Inputs"},{type:"heading",depth:2,children:[{type:"text",value:"Turn off caching",position:{start:{line:110,column:4,offset:4756},end:{line:110,column:20,offset:4772}}}],position:{start:{line:110,column:1,offset:4753},end:{line:110,column:20,offset:4772}},value:"Turn off caching"},{type:"heading",depth:2,children:[{type:"text",value:"Alter Caching Based on File Changes",position:{start:{line:133,column:4,offset:5455},end:{line:133,column:39,offset:5490}}}],position:{start:{line:133,column:1,offset:5452},end:{line:133,column:39,offset:5490}},value:"Alter Caching Based on File Changes"},{type:"heading",depth:2,children:[{type:"text",value:"Altering Caching Based on Environment Variables",position:{start:{line:184,column:4,offset:7022},end:{line:184,column:51,offset:7069}}}],position:{start:{line:184,column:1,offset:7019},end:{line:184,column:51,offset:7069}},value:"Altering Caching Based on Environment Variables"},{type:"heading",depth:3,children:[{type:"text",value:"Automatic environment variable inclusion",position:{start:{line:259,column:5,offset:9264},end:{line:259,column:45,offset:9304}}}],position:{start:{line:259,column:1,offset:9260},end:{line:259,column:45,offset:9304}},value:"Automatic environment variable inclusion"},{type:"heading",depth:4,children:[{type:"text",value:"A note on monorepos",position:{start:{line:305,column:6,offset:11104},end:{line:305,column:25,offset:11123}}}],position:{start:{line:305,column:1,offset:11099},end:{line:305,column:25,offset:11123}},value:"A note on monorepos"},{type:"heading",depth:3,children:[{type:"inlineCode",value:"eslint-config-turbo",position:{start:{line:323,column:5,offset:12412},end:{line:323,column:26,offset:12433}}}],position:{start:{line:323,column:1,offset:12408},end:{line:323,column:26,offset:12433}},value:"eslint-config-turbo"},{type:"heading",depth:3,children:[{type:"text",value:"Invisible Environment Variables",position:{start:{line:350,column:5,offset:13840},end:{line:350,column:36,offset:13871}}}],position:{start:{line:350,column:1,offset:13836},end:{line:350,column:36,offset:13871}},value:"Invisible Environment Variables"},{type:"heading",depth:2,children:[{type:"text",value:"Force overwrite cache",position:{start:{line:367,column:4,offset:14617},end:{line:367,column:25,offset:14638}}}],position:{start:{line:367,column:1,offset:14614},end:{line:367,column:25,offset:14638}},value:"Force overwrite cache"},{type:"heading",depth:2,children:[{type:"text",value:"Logs",position:{start:{line:377,column:4,offset:14854},end:{line:377,column:8,offset:14858}}}],position:{start:{line:377,column:1,offset:14851},end:{line:377,column:8,offset:14858}},value:"Logs"},{type:"heading",depth:2,children:[{type:"text",value:"Hashing",position:{start:{line:381,column:4,offset:15179},end:{line:381,column:11,offset:15186}}}],position:{start:{line:381,column:1,offset:15176},end:{line:381,column:11,offset:15186}},value:"Hashing"}],unstable_flexsearch:!0};globalThis.__nextra_internal__={pageMap:j.pageMap,route:j.route};function m(e){var n=Object.assign({h1:"h1",p:"p",code:"code",strong:"strong",h2:"h2",ul:"ul",li:"li",ol:"ol",a:"a",div:"div",pre:"pre",span:"span",em:"em",h3:"h3",h4:"h4"},(0,c.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"Caching Tasks"}),"\n",(0,t.jsxs)(n.p,{children:["Every JavaScript or TypeScript codebase will need to run ",(0,t.jsx)(n.code,{children:"package.json"})," scripts, like ",(0,t.jsx)(n.code,{children:"build"}),", ",(0,t.jsx)(n.code,{children:"test"})," and ",(0,t.jsx)(n.code,{children:"lint"}),". In Turborepo, we call these ",(0,t.jsx)(n.strong,{children:"tasks"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Turborepo can cache the results and logs of your tasks - leading to enormous speedups for slow tasks."}),"\n",(0,t.jsx)(n.h2,{id:"missing-the-cache",children:"Missing the cache"}),"\n",(0,t.jsxs)(n.p,{children:["Each task in your codebase has ",(0,t.jsx)(n.strong,{children:"inputs"})," and ",(0,t.jsx)(n.strong,{children:"outputs"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.code,{children:"build"})," task might have source files as inputs and outputs logs to ",(0,t.jsx)(n.code,{children:"stderr"})," and ",(0,t.jsx)(n.code,{children:"stdout"})," as well as bundled files."]}),"\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.code,{children:"lint"})," or ",(0,t.jsx)(n.code,{children:"test"})," task might have source files as inputs and outputs logs to ",(0,t.jsx)(n.code,{children:"stdout"})," and ",(0,t.jsx)(n.code,{children:"stderr"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Let's say you run a ",(0,t.jsx)(n.code,{children:"build"})," task with Turborepo using ",(0,t.jsx)(n.code,{children:"turbo run build"}),":"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(h(),{placeholder:"blur",src:p})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Turborepo will ",(0,t.jsx)(n.strong,{children:"evaluate the inputs to your task"})," (by default all non-gitignored files in the workspace folder) and ",(0,t.jsx)(n.strong,{children:"turn them into a hash"})," (e.g. ",(0,t.jsx)(n.code,{children:"78awdk123"}),")."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Check the local filesystem cache"})," for a folder named with the hash (e.g.",(0,t.jsx)(n.code,{children:"./node_modules/.cache/turbo/78awdk123"}),")."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If Turborepo doesn't find any matching artifacts for the calculated hash, Turborepo will then ",(0,t.jsx)(n.strong,{children:"execute the task"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Once the task is over, Turborepo ",(0,t.jsx)(n.strong,{children:"saves all the outputs"})," (including files and logs) into its cache under the hash."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(u.Z,{type:"info",children:(0,t.jsxs)(n.p,{children:["Turborepo takes a lot of information into account when creating the hash -\nsource files, environment variables, and even the source files of dependent\nworkspaces. Learn more ",(0,t.jsx)(n.a,{href:"/docs/core-concepts/caching#hashing",children:"below"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"hitting-the-cache",children:"Hitting the cache"}),"\n",(0,t.jsx)(n.p,{children:"Let's say that you run the task again without changing any of its inputs:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(h(),{placeholder:"blur",src:x})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"hash will be the same"})," because ",(0,t.jsx)(n.strong,{children:"the inputs haven't changed"})," (e.g. ",(0,t.jsx)(n.code,{children:"78awdk123"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Turborepo will find the folder in its cache with the calculated hash (e.g. ",(0,t.jsx)(n.code,{children:"./node_modules/.cache/turbo/78awdk123"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Instead of running the task"}),", Turborepo will ",(0,t.jsx)(n.strong,{children:"replay the output"})," - printing the saved logs to ",(0,t.jsx)(n.code,{children:"stdout"})," and restoring the saved output files to their respective position in the filesystem."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Restoring files and logs from the cache happens near-instantaneously. This can take your build times from minutes or hours down to seconds or milliseconds. Although specific results will vary depending on the shape and granularity of your codebase's dependency graph, most teams find that they can cut their overall monthly build time by around 40-85% with Turborepo's caching."}),"\n",(0,t.jsx)(n.h2,{id:"configuring-cache-outputs",children:"Configuring Cache Outputs"}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.a,{href:"../reference/configuration#pipeline",children:(0,t.jsx)(n.code,{children:"pipeline"})}),", you can configure cache conventions across your Turborepo."]}),"\n",(0,t.jsxs)(n.p,{children:["To override the default cache output behavior, pass an array of globs to a ",(0,t.jsx)(n.a,{href:"../reference/configuration#outputs",children:(0,t.jsx)(n.code,{children:"pipeline.<task>.outputs"})})," array. Any file that satisfies the glob patterns for a task will be treated as artifact."]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"$schema"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://turborepo.org/schema.json"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"dist/**"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'".next/**"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"^build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"test"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// leave empty to only cache logs"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:["If your task does not emit any files (e.g. unit tests with Jest), set ",(0,t.jsx)(n.code,{children:"outputs"})," to an empty array (i.e. ",(0,t.jsx)(n.code,{children:"[]"}),"), and Turborepo will cache the logs for you."]}),"\n",(0,t.jsxs)(n.p,{children:["When you run ",(0,t.jsx)(n.code,{children:"turbo run build test"}),", Turborepo will execute your build and test scripts,\nand cache their ",(0,t.jsx)(n.code,{children:"output"}),"s in ",(0,t.jsx)(n.code,{children:"./node_modules/.cache/turbo"}),"."]}),"\n",(0,t.jsx)(u.Z,{type:"info",children:(0,t.jsxs)(n.p,{children:["Pro Tip for caching ESLint: You can get a cacheable pretty terminal output\n(even for non-errors) by setting ",(0,t.jsx)(n.code,{children:"TIMING=1"})," variable before ",(0,t.jsx)(n.code,{children:"eslint"}),". Learn\nmore over in the ",(0,t.jsx)(n.a,{href:"https://eslint.org/docs/latest/developer-guide/working-with-rules#per-rule-performance",children:"ESLint\ndocs"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"configuring-cache-inputs",children:"Configuring Cache Inputs"}),"\n",(0,t.jsxs)(n.p,{children:["A workspace is considered to have been updated when any of the files in that workspace have changed.\nHowever, for some tasks, we only want to rerun that task when relevant files have changed.\nSpecifying ",(0,t.jsx)(n.code,{children:"inputs"})," lets us define which files are relevant for a particular task. For example, the\n",(0,t.jsx)(n.code,{children:"test"})," configuration below declares that the ",(0,t.jsx)(n.code,{children:"test"})," task only needs to execute if a ",(0,t.jsx)(n.code,{children:".tsx"})," or ",(0,t.jsx)(n.code,{children:".ts"})," file\nin the ",(0,t.jsx)(n.code,{children:"src/"})," and ",(0,t.jsx)(n.code,{children:"test/"})," subdirectories has changed since the last execution."]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"$schema"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://turborepo.org/schema.json"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ... omitted for brevity"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:" "}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"test"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// A workspace's `test` task depends on that workspace's"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// own `build` task being completed first."})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// A workspace's `test` task should only be rerun when"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// either a `.tsx` or `.ts` file has changed."})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"inputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"src/**/*.tsx"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"src/**/*.ts"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"test/**/*.ts"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(n.h2,{id:"turn-off-caching",children:"Turn off caching"}),"\n",(0,t.jsxs)(n.p,{children:["Sometimes you really don't need or want this cache behavior (e.g. when you're using ",(0,t.jsx)(n.a,{href:"https://nextjs.org/docs/api-reference/cli#development",children:(0,t.jsx)(n.code,{children:"next dev"})})," or ",(0,t.jsx)(n.code,{children:"react-scripts start"})," for live reloading). To entirely disable caching, append ",(0,t.jsx)(n.code,{children:"--no-cache"})," to any command:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"shell","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# Run `dev` npm script in all workspaces in parallel,"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# but don't cache the output"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"turbo run dev --parallel --no-cache"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:["You can also disable caching on specific tasks by setting the ",(0,t.jsx)(n.a,{href:"../reference/configuration#pipeline-1",children:(0,t.jsx)(n.code,{children:"pipeline.<task>.cache"})})," configuration to ",(0,t.jsx)(n.code,{children:"false"}),":"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"json","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"$schema"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://turborepo.org/schema.json"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dev"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"cache"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"false"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(n.h2,{id:"alter-caching-based-on-file-changes",children:"Alter Caching Based on File Changes"}),"\n",(0,t.jsxs)(n.p,{children:["For some tasks, you may not want a cache miss if an irrelevant file has changed. For instance, updating ",(0,t.jsx)(n.code,{children:"README.md"}),"\nmight not need to trigger a cache miss for the ",(0,t.jsx)(n.code,{children:"test"})," task. You can use ",(0,t.jsx)(n.code,{children:"inputs"})," to restrict the set\nof files ",(0,t.jsx)(n.code,{children:"turbo"})," considers for a particular task. In this case, only consider ",(0,t.jsx)(n.code,{children:".ts"})," and ",(0,t.jsx)(n.code,{children:".tsx"})," files relevant for\ndetermining a cache hit on the ",(0,t.jsx)(n.code,{children:"test"})," task:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"$schema"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://turborepo.org/schema.json"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ...other tasks"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"test"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// leave empty to only cache logs"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"inputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"src/**/*.tsx"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"src/**/*.ts"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"test/**/*.ts"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(u.Z,{type:"info",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"package.json"})," is ",(0,t.jsx)(n.em,{children:"always"})," considered an input for tasks in the workspace it\nlives in. This is because the ",(0,t.jsx)(n.em,{children:"definition"})," of the task itself lives in\n",(0,t.jsx)(n.code,{children:"package.json"})," in the ",(0,t.jsx)(n.code,{children:"scripts"})," key. If you change that, any cached output is\nconsidered invalid."]})}),"\n",(0,t.jsxs)(n.p,{children:["If you want ",(0,t.jsx)(n.em,{children:"all"})," tasks to depend on certain files, you can declare this dependency in the\n",(0,t.jsx)(n.code,{children:"globalDependencies"})," array."]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"diff","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  "$schema": "https://turborepo.org/schema.json",'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"#4BB74A"},children:'+  "globalDependencies": [".env"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  "pipeline": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    // ...other tasks"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'    "test": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "outputs": [], // leave empty to only cache logs'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "dependsOn": ["build"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "inputs": ["src/**/*.tsx", "src/**/*.ts", "test/**/*.ts"]'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(u.Z,{type:"info",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"turbo.json"})," is ",(0,t.jsx)(n.em,{children:"always"})," considered a global dependency. If you modify\n",(0,t.jsx)(n.code,{children:"turbo.json"}),", all caches are invalidated."]})}),"\n",(0,t.jsx)(n.h2,{id:"altering-caching-based-on-environment-variables",children:"Altering Caching Based on Environment Variables"}),"\n",(0,t.jsxs)(n.p,{children:["When you use ",(0,t.jsx)(n.code,{children:"turbo"})," with tools that inline environment variables at build time\n(e.g. ",(0,t.jsx)(n.a,{href:"https://nextjs.org/docs/basic-features/environment-variables#exposing-environment-variables-to-the-browser",children:"Next.js"})," or ",(0,t.jsx)(n.a,{href:"https://create-react-app.dev/docs/adding-custom-environment-variables/",children:"Create React App"}),"), it is important to tell ",(0,t.jsx)(n.code,{children:"turbo"})," about it.\nOtherwise, you could ship a cached build with the wrong environment variables!"]}),"\n",(0,t.jsxs)(n.p,{children:["You can control ",(0,t.jsx)(n.code,{children:"turbo"}),"'s caching behavior based on\nthe values of environment variables:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Including environment variables in the ",(0,t.jsx)(n.code,{children:"env"})," key in your ",(0,t.jsx)(n.code,{children:"pipeline"})," definition will impact the cache fingerprint on a per-task or per-workspace-task basis."]}),"\n",(0,t.jsxs)(n.li,{children:["The value of any environment variable that includes ",(0,t.jsx)(n.code,{children:"THASH"})," in its name will impact the cache fingerprint of ",(0,t.jsx)(n.em,{children:"all"})," tasks."]}),"\n"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"$schema"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://turborepo.org/schema.json"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"^build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:'// env vars will impact hashes of all "build" tasks'})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"env"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SOME_ENV_VAR"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"dist/**"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:" "}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:'// override settings for the "build" task for the "web" app'})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"web#build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"^build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"env"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:'// env vars that will impact the hash of "build" task for only "web" app'})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STRIPE_SECRET_KEY"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"NEXT_PUBLIC_STRIPE_PUBLIC_KEY"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"NEXT_PUBLIC_ANALYTICS_ID"'})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      ]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"outputs"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'".next/**"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(u.Z,{type:"info",children:(0,t.jsxs)(n.p,{children:["Declaring environment variables in the ",(0,t.jsx)(n.code,{children:"dependsOn"})," config with a ",(0,t.jsx)(n.code,{children:"$"})," prefix is\ndeprecated."]})}),"\n",(0,t.jsxs)(n.p,{children:["To alter the cache for ",(0,t.jsx)(n.em,{children:"all"})," tasks, you can declare environment variables in the\n",(0,t.jsx)(n.code,{children:"globalEnv"})," array:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"diff","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  "$schema": "https://turborepo.org/schema.json",'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  "pipeline": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'    "build": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "dependsOn": ["^build"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      // env vars will impact hashes of all "build" tasks'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "env": ["SOME_ENV_VAR"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "outputs": ["dist/**"]'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    },"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:" "}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'    // override settings for the "build" task for the "web" app'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'    "web#build": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "dependsOn": ["^build"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "env": ['})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'        // env vars that will impact the hash of "build" task for only "web" app'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'        "STRIPE_SECRET_KEY",'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'        "NEXT_PUBLIC_STRIPE_PUBLIC_KEY",'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'        "NEXT_PUBLIC_ANALYTICS_ID"'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      ],"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "outputs": [".next/**"],'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    },"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  },"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"#4BB74A"},children:'+  "globalEnv": ['})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"#4BB74A"},children:'+    "GITHUB_TOKEN" // env var that will impact the hashes of all tasks,'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"#4BB74A"},children:"+  ]"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(n.h3,{id:"automatic-environment-variable-inclusion",children:"Automatic environment variable inclusion"}),"\n",(0,t.jsxs)(n.p,{children:["To help ensure correct caching across environments, Turborepo automatically infers and includes public environment variables when calculating cache keys for apps built with detected frameworks. You can safely omit framework-specific public environment variables from ",(0,t.jsx)(n.code,{children:"turbo.json"}),":"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{filename:"turbo.json",children:(0,t.jsxs)(n.code,{"data-language":"diff","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  "pipeline": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'    "build": {'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'      "env": ['})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"#EF6270"},children:'-       "NEXT_PUBLIC_EXAMPLE_ENV_VAR"'})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      ]"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsx)(n.p,{children:"Note that this automatic detection and inclusion only works if Turborepo successfully infers the framework your apps are built with. The supported frameworks and the environment variables that Turborepo will detect and include in the cache keys:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Astro: ",(0,t.jsx)(n.code,{children:"PUBLIC_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Blitz: ",(0,t.jsx)(n.code,{children:"NEXT_PUBLIC_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Create React App: ",(0,t.jsx)(n.code,{children:"REACT_APP_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Gatsby: ",(0,t.jsx)(n.code,{children:"GATSBY_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Next.js: ",(0,t.jsx)(n.code,{children:"NEXT_PUBLIC_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Nuxt.js: ",(0,t.jsx)(n.code,{children:"NUXT_ENV_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["RedwoodJS: ",(0,t.jsx)(n.code,{children:"REDWOOD_ENV_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Sanity Studio: ",(0,t.jsx)(n.code,{children:"SANITY_STUDIO_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Solid: ",(0,t.jsx)(n.code,{children:"VITE_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["SvelteKit: ",(0,t.jsx)(n.code,{children:"VITE_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Vite: ",(0,t.jsx)(n.code,{children:"VITE_*"})]}),"\n",(0,t.jsxs)(n.li,{children:["Vue: ",(0,t.jsx)(n.code,{children:"VUE_APP_*"})]}),"\n"]}),"\n",(0,t.jsxs)(u.Z,{type:"info",children:[(0,t.jsxs)(n.p,{children:["There are some exceptions to the list above. For various reasons, CI systems (including Vercel)\nset environment variables that start with these prefixes even though they aren't part of your build\noutput. These can change unpredictably \u2014 even on every build! \u2014 invalidating Turborepo's\ncache. To workaround this, Turborepo uses a ",(0,t.jsx)(n.code,{children:"TURBO_CI_VENDOR_ENV_KEY"})," variable to\n",(0,t.jsx)(n.em,{children:"exclude"})," environment variables from Turborepo's inference."]}),(0,t.jsxs)(n.p,{children:["For example, Vercel sets the ",(0,t.jsx)(n.code,{children:"NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA"}),". This value changes on every build,\nso Vercel ",(0,t.jsx)(n.em,{children:"also"})," sets ",(0,t.jsx)(n.code,{children:'TURBO_CI_VENDOR_ENV_KEY="NEXT_PUBLIC_VERCEL_"'})," to exclude these variables."]}),(0,t.jsx)(n.p,{children:"Luckily, you only need to be aware of this on other build systems; you don't need to worry\nabout these edge cases when using Turborepo on Vercel."})]}),"\n",(0,t.jsx)(n.h4,{id:"a-note-on-monorepos",children:"A note on monorepos"}),"\n",(0,t.jsx)(n.p,{children:"The environment variables will only be included in the cache key for tasks in workspaces where that framework is used. In other words, environment variables inferred for Next.js apps will only be included in the cache key for workspaces detected as Next.js apps. Tasks in other workspaces in the monorepo will not be impacted."}),"\n",(0,t.jsxs)(n.p,{children:["For example, consider a monorepo with three workspaces: a Next.js project, a Create React App project, and a TypeScript package. Each has a ",(0,t.jsx)(n.code,{children:"build"})," script, and both apps depend on the TypeScript project. Let's say that this Turborepo has a standard ",(0,t.jsx)(n.code,{children:"turbo.json"})," pipeline that builds them all in order:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{filename:"turbo.json",children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"pipeline"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"dependsOn"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"^build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:["As of 1.4, when you run ",(0,t.jsx)(n.code,{children:"turbo run build"}),", Turborepo will not consider any build time environment variables relevant when building the TypeScript package. However, when building the Next.js app, Turborepo will infer that environment variables starting with ",(0,t.jsx)(n.code,{children:"NEXT_PUBLIC_"})," could alter the output of the ",(0,t.jsx)(n.code,{children:".next"})," folder and should thus be included when calculating the hash. Similarly, when calculating the hash of the Create React App's ",(0,t.jsx)(n.code,{children:"build"})," script, all build time environment variables starting with ",(0,t.jsx)(n.code,{children:"REACT_APP_PUBLIC_"})," will be included."]}),"\n",(0,t.jsx)(n.h3,{id:"eslint-config-turbo",children:(0,t.jsx)(n.code,{children:"eslint-config-turbo"})}),"\n",(0,t.jsxs)(n.p,{children:["To further assist in detecting unseen dependencies creeping into your builds, and to help ensure that your Turborepo cache is correctly shared across every environment, use the ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/eslint-config-turbo",children:(0,t.jsx)(n.code,{children:"eslint-config-turbo"})})," package. While automatic environment variable inclusion should cover most situations with most frameworks, this ESLint config will provide just-in-time feedback for teams using other build time inlined environment variables. This will also help support teams using in-house frameworks that we cannot detect automatically."]}),"\n",(0,t.jsxs)(n.p,{children:["To get started, extend from ",(0,t.jsx)(n.code,{children:"eslint-config-turbo"})," in your root ",(0,t.jsx)(n.a,{href:"https://eslint.org/docs/latest/user-guide/configuring/configuration-files#configuration-file-formats",children:(0,t.jsx)(n.code,{children:"eslintrc"})})," file:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// Automatically flag env vars missing from turbo.json"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"extends"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"turbo"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:["For more control over the rules, you can install and configure the ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/eslint-plugin-turbo",children:(0,t.jsx)(n.code,{children:"eslint-plugin-turbo"})})," ",(0,t.jsx)(n.em,{children:"plugin"})," directly by first adding it to plugins and then configuring the desired rules:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"jsonc","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"plugins"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"turbo"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"rules"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// Automatically flag env vars missing from turbo.json"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"turbo/no-undeclared-env-vars"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"error"'})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:["The plugin will warn you if you are using non-framework-related environment variables in your code that have not been declared in your ",(0,t.jsx)(n.code,{children:"turbo.json"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"invisible-environment-variables",children:"Invisible Environment Variables"}),"\n",(0,t.jsxs)(n.p,{children:["Since Turborepo runs ",(0,t.jsx)(n.em,{children:"before"})," your tasks, it is possible for your tasks to create or mutate environment variables after ",(0,t.jsx)(n.code,{children:"turbo"})," has already calculated the hash for a particular task. For example, consider this ",(0,t.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"json","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"scripts"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"NEXT_PUBLIC_GA_ID=UA-00000000-0 next build"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"test"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"node -r dotenv/config test.js"'})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"turbo"}),", having calculated a task hash prior to invoking the ",(0,t.jsx)(n.code,{children:"build"})," script, will be unable to discover the ",(0,t.jsx)(n.code,{children:"NEXT_PUBLIC_GA_ID=UA-00000000-0"})," environment variable and thus unable to partition the cache based upon that, or any environment variable configured by ",(0,t.jsx)(n.code,{children:"dotenv"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Be careful to ensure that all of your environment variables are configured prior to invoking ",(0,t.jsx)(n.code,{children:"turbo"}),"!"]}),"\n",(0,t.jsx)(n.h2,{id:"force-overwrite-cache",children:"Force overwrite cache"}),"\n",(0,t.jsxs)(n.p,{children:["Conversely, if you want to force ",(0,t.jsx)(n.code,{children:"turbo"})," to re-execute a previously cached task, add the ",(0,t.jsx)(n.code,{children:"--force"})," flag:"]}),"\n",(0,t.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,t.jsx)(n.pre,{children:(0,t.jsxs)(n.code,{"data-language":"shell","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# Run `build` npm script in all workspaces,"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# ignoring cache hits."})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"turbo run build --force"})})]})})}),"\n",(0,t.jsx)(n.h2,{id:"logs",children:"Logs"}),"\n",(0,t.jsxs)(n.p,{children:["Not only does ",(0,t.jsx)(n.code,{children:"turbo"})," cache the output of your tasks, it also records the terminal output (i.e. combined ",(0,t.jsx)(n.code,{children:"stdout"})," and ",(0,t.jsx)(n.code,{children:"stderr"}),") to (",(0,t.jsx)(n.code,{children:"<package>/.turbo/run-<command>.log"}),"). When ",(0,t.jsx)(n.code,{children:"turbo"})," encounters a cached task, it will replay the output as if it happened again, but instantly, with the package name slightly dimmed."]}),"\n",(0,t.jsx)(n.h2,{id:"hashing",children:"Hashing"}),"\n",(0,t.jsxs)(n.p,{children:["By now, you're probably wondering how ",(0,t.jsx)(n.code,{children:"turbo"})," decides what constitutes a cache hit vs. miss for a given task. Good question!"]}),"\n",(0,t.jsxs)(n.p,{children:["First, ",(0,t.jsx)(n.code,{children:"turbo"})," constructs a hash of the current global state of the codebase:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The contents of any files that satisfy the glob patterns and any the values of environment variables listed in ",(0,t.jsx)(n.a,{href:"../reference/configuration#globalDependencies-1",children:(0,t.jsx)(n.code,{children:"globalDependencies"})})]}),"\n",(0,t.jsxs)(n.li,{children:["The sorted list environment variable key-value pairs that include ",(0,t.jsx)(n.code,{children:"THASH"})," ",(0,t.jsx)(n.em,{children:"anywhere"})," in their names (e.g. ",(0,t.jsx)(n.code,{children:"STRIPE_PUBLIC_THASH_SECRET_KEY"}),", but not ",(0,t.jsx)(n.code,{children:"STRIPE_PUBLIC_KEY"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Then it adds more factors relevant to a given workspace's task:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Hash the contents of all version-controlled files in the workspace folder or the files matching the ",(0,t.jsx)(n.code,{children:"inputs"})," globs, if present"]}),"\n",(0,t.jsx)(n.li,{children:"The hashes of all internal dependencies"}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"outputs"})," option specified in the ",(0,t.jsx)(n.a,{href:"../reference/configuration#pipeline",children:(0,t.jsx)(n.code,{children:"pipeline"})})]}),"\n",(0,t.jsxs)(n.li,{children:["The set of resolved versions of all installed ",(0,t.jsx)(n.code,{children:"dependencies"}),", ",(0,t.jsx)(n.code,{children:"devDependencies"}),", and ",(0,t.jsx)(n.code,{children:"optionalDependencies"})," specified in a workspace's ",(0,t.jsx)(n.code,{children:"package.json"})," from the root lockfile"]}),"\n",(0,t.jsx)(n.li,{children:"The workspace task's name"}),"\n",(0,t.jsxs)(n.li,{children:["The sorted list of environment variable key-value pairs that correspond to the environment variable names listed in applicable ",(0,t.jsx)(n.a,{href:"../reference/configuration#dependson",children:(0,t.jsx)(n.code,{children:"pipeline.<task-or-package-task>.dependsOn"})})," list."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Once ",(0,t.jsx)(n.code,{children:"turbo"})," encounters a given workspace's task in its execution, it checks the cache (both locally and remotely) for a matching hash. If it's a match, it skips executing that task, moves or downloads the cached output into place and replays the previously recorded logs instantly. If there isn't anything in the cache (either locally or remotely) that matches the calculated hash, ",(0,t.jsx)(n.code,{children:"turbo"})," will execute the task locally and then cache the specified ",(0,t.jsx)(n.code,{children:"outputs"})," using the hash as an index."]}),"\n",(0,t.jsxs)(n.p,{children:["The hash of a given task is injected at execution time as an environment variable ",(0,t.jsx)(n.code,{children:"TURBO_HASH"}),". This value can be useful in stamping outputs or tagging Dockerfile etc."]}),"\n",(0,t.jsx)(u.Z,{children:(0,t.jsxs)(n.p,{children:["As of ",(0,t.jsx)(n.code,{children:"turbo"})," v0.6.10, ",(0,t.jsx)(n.code,{children:"turbo"}),"'s hashing algorithm when using ",(0,t.jsx)(n.code,{children:"npm"})," or ",(0,t.jsx)(n.code,{children:"pnpm"}),"\ndiffers slightly from the above. When using either of these package managers,\n",(0,t.jsx)(n.code,{children:"turbo"})," will include the hashed contents of the lockfile in its hash algorithm\nfor each workspace's task. It will ",(0,t.jsx)(n.em,{children:"not"})," parse/figure out the resolved set of\nall dependencies like the current ",(0,t.jsx)(n.code,{children:"yarn"})," implementation."]})})]})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},(0,c.ah)(),e.components),s=n.wrapper;return s?(0,t.jsx)(s,(0,i.Z)((0,r.Z)({},e),{children:(0,t.jsx)(m,(0,r.Z)({},e))})):m(e)}j.title="Caching";(o=globalThis).__nextra_pageContext__||(o.__nextra_pageContext__=Object.create(null)),globalThis.__nextra_pageContext__["/repo/docs/core-concepts/caching"]={Content:function(e){return(0,t.jsx)(a.mK.Provider,{value:e,children:(0,t.jsx)(g,{})})},pageOpts:j,themeConfig:l.Z}}},function(e){e.O(0,[8002,8583,9774,2888,179],(function(){return n=3165,e(e.s=n);var n}));var n=e.O();_N_E=n}]);